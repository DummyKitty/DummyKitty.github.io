---
title: GOAD 靶场环境搭建
date: 2023-11-28 10:29:48
categories:
- Pentest
tags:
- GOAD
- Active Directory
toc: true
---

# GOAD 靶场搭建
下面是官方的搭建教程链接：
- [Game Of Active Directory v2](https://mayfly277.github.io/posts/GOADv2/)

vagrant 下载并启动虚拟机一般没有什么问题。
```bash
vagrant up
```

但当我执行 ansible 的命令时
```bash
ansible-playbook main.yml
```
所有条目都是报 No hosts matched, nothing to do 的错误。寻找了其他教程貌似都没有遇到这类的错误：
- [域渗透靶场GOAD(Game Of Active Directory) v2 搭建教程 - NO SYSTEM IS SAFE](https://qusec.cn/posts/G0AD/#7-%E6%8E%A8%E8%8D%90-%E5%88%9B%E5%BB%BAubuntu%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%AE%89%E8%A3%85ansible-%E5%B9%B6%E9%85%8D%E7%BD%AE%E9%9D%B6%E5%9C%BA%E7%8E%AF%E5%A2%83)
- [Windows下配置安装GOAD - InfoSec's Blog](https://guosec.online/posts/ad6be596.html)

几个安装教程都是几个月之前的了，在此期间 GOAD 有一些更新，暂且不看更新了哪些内容，查看官方提供的安装脚本 GOAD.sh，在其中搜索 ansible-playbook 可以找到这个脚本是如何运行这部分的内容的：

linux 本地启动
```bash
cd ansible

export ANSIBLE_COMMAND="ansible-playbook -i ../ad/GOAD/data/inventory -i ../ad/GOAD/providers/vmware/inventory"

../scripts/provisionning.sh
```

换用上述的命令就可以正常执行了。

如果想使用 docker 的话，可以先 build 镜像。
```bash
docker build -t goadansible --network host .
```

然后运行，命令如下
```bash
docker run -ti --rm --network host -h goadansible -v $(pwd):/goad -w /goad/ansible goadansible /bin/bash -c "ANSIBLE_COMMAND='ansible-playbook -i ../ad/GOAD/data/inventory -i ../ad/GOAD/providers/vmware/inventory' ../scripts/provisionning.sh"
```

![20231128021540](https://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/20231128021540.png)

配置期间可能会出现各种各样的错误，这时候只能求助 issue 了，一般性的问题其他人也会碰到：
1. [Issues · Orange-Cyberdefense/GOAD](https://github.com/Orange-Cyberdefense/GOAD/issues/69)

我遇到的是 SRV02 添加 admin 用户时的一个报错，在 issue 里可以看到也有人遇到过相同问题，但没有解决。 
- https://github.com/Orange-Cyberdefense/GOAD/issues/62

![20231128203931](https://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/20231128203931.png)

最后只能自行解决了，具体步骤可见该 [issue](https://github.com/Orange-Cyberdefense/GOAD/issues/62)


# 参考
- [域渗透靶场GOAD(Game Of Active Directory) v2 搭建教程 - NO SYSTEM IS SAFE](https://qusec.cn/posts/G0AD/#7-%E6%8E%A8%E8%8D%90-%E5%88%9B%E5%BB%BAubuntu%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%AE%89%E8%A3%85ansible-%E5%B9%B6%E9%85%8D%E7%BD%AE%E9%9D%B6%E5%9C%BA%E7%8E%AF%E5%A2%83)
- [Windows下配置安装GOAD - InfoSec's Blog](https://guosec.online/posts/ad6be596.html)
